/**
 * cxCalendar
 * @version 3.0.2
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxCalendar
 * @license Released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cxCalendar=t()}(this,(function(){"use strict";const e={dom:{},reg:{isYear:/^\d{4}$/,isTime:/^\d{1,2}(\:\d{1,2}){1,2}$/},cacheDate:{},cxId:1,bindFuns:{},isElement:function(e){return!(!e||"function"!=typeof HTMLElement&&"object"!=typeof HTMLElement||!(e instanceof HTMLElement))||!(!e||!e.nodeType||1!==e.nodeType)},isInteger:function(e){return"string"==typeof e&&/^\-?\d+$/.test(e)&&(e=parseInt(e,10)),"number"==typeof e&&isFinite(e)},isObject:function(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)&&!(e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))},isDate:function(e){return(e instanceof Date||"[object Date]"===Object.prototype.toString.call(e))&&isFinite(e.getTime())}};let t;e.extend=function(e,...t){const a=this;if(a.isObject(e)){for(let n of t)if(a.isObject(n))for(let t in n)Array.isArray(n[t])?e[t]=[].concat(n[t]):a.isObject(n[t])?(a.isObject(e[t])||(e[t]={}),a.extend(e[t],n[t])):e[t]=n[t];return e}},e.fillLeadZero=function(e,t){let a=String(e);return a.length<t&&(a=Array(t-a.length).fill(0).join("")+e),a},e.getMonthDays=function(e){return[31,28+(e%4==0&&e%100!=0||e%400==0?1:0),31,30,31,30,31,31,30,31,30,31]},e.getWeekNum=function(e){const t=this,a=e.getTime(),n=new Date(e.getFullYear(),0,1,0,0,0,0);let s=n.getTime(),i=n.getDay(),o=0;return 0===i&&(i=7),s+=i>4?864e5*(8-i):864e5*(1-i),a<s?o=t.getWeekNum(new Date(e.getFullYear()-1,11,31)):(o=Math.floor((a-s)/864e5)+1,o=Math.ceil(o/7)),o},e.parseDate=function(e,t){const a=this;let n=new Date;if(a.reg.isYear.test(e))n.setFullYear(parseInt(e,10));else if(a.isInteger(e))n.setTime(parseInt(e,10));else if("string"==typeof e&&e.length){let t;a.reg.isTime.test(e)?(t=e.split(":").map((e=>parseInt(e,10))),t.length<4?t=t.concat(Array(4-t.length).fill(0)):t.length>4&&(t.length=4),n.setHours.apply(n,t)):(e=e.replace(/[\.\/]/g,"-"),/^\d{1,2}-\d{1,2}/.test(e)?e=n.getFullYear()+"-"+e:/^\d{4}-\d{1,2}$/.test(e)&&(e+="-1"),t=e.split(/[\-\sT\:]/).map((e=>parseInt(e,10))),t.length>1&&(t[1]-=1),t.length<7?t=t.concat(Array(7-t.length).fill(0)):t.length>7&&(t.length=7),n.setFullYear.apply(n,t.slice(0,3)),n.setHours.apply(n,t.slice(3)))}else n=null;return!0!==t||a.isDate(n)||(n=new Date),n},e.formatDate=function(e,a){const n=this,s=n.parseDate(a);if("string"!=typeof e||!n.isDate(s))return a;const i={Y:s.getFullYear(),n:s.getMonth()+1,j:s.getDate(),G:s.getHours(),timestamp:s.getTime()};i.y=i.Y.toString(10).slice(-2),i.m=n.fillLeadZero(i.n,2),i.d=n.fillLeadZero(i.j,2),i.W=n.getWeekNum(s),i.H=n.fillLeadZero(i.G,2),i.g=i.G>12?i.G-12:i.G,i.h=n.fillLeadZero(i.g,2),i.i=n.fillLeadZero(s.getMinutes(),2),i.s=n.fillLeadZero(s.getSeconds(),2),i.a=i.G>12?t.language.pm:t.language.am;const o=["timestamp","Y","y","m","n","d","j","W","H","h","G","g","i","s","a"],r=new RegExp("("+o.join("|")+")","g");let l=e;l=l.replace(/([\{\}])/g,"\\$1"),l=l.replace(r,((e,t)=>"{{"+t+"}}")),l=l.replace(/\\\{\{(.)\}\}/g,"$1");for(let e of o)l=l.replace(new RegExp("{{"+e+"}}","g"),i[e]);return l=l.replace(/\\(.)/g,"$1"),l},e.getLanguage=function(e){return this.isObject(e)?e:("string"==typeof e&&e.length||("string"==typeof navigator.language?e=navigator.language:"string"==typeof navigator.browserLanguage&&(e=navigator.browserLanguage)),"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof e&&e.length&&"object"==typeof n.languages[e]?n.languages[e]:n.languages.default)},e.init=function(){this.buildStage(),this.bindEvent()},e.buildStage=function(){const e=this;e.dom.maskBg=document.createElement("div"),e.dom.maskBg.classList.add("cxcalendar_mask"),e.dom.panel=document.createElement("div"),e.dom.panel.classList.add("cxcalendar"),e.dom.head=document.createElement("div"),e.dom.head.classList.add("cxcalendar_hd"),e.dom.main=document.createElement("div"),e.dom.main.classList.add("cxcalendar_bd"),e.dom.acts=document.createElement("div"),e.dom.acts.classList.add("cxcalendar_acts"),e.dom.dateSet=document.createElement("div"),e.dom.timeSet=document.createElement("div"),e.dom.timeSet.classList.add("times"),e.dom.panel.insertAdjacentElement("beforeend",e.dom.main),document.body.insertAdjacentElement("beforeend",e.dom.panel),e.dom.panel.insertAdjacentElement("afterend",e.dom.maskBg)},e.bindEvent=function(){const e=this;e.dom.maskBg.addEventListener("click",(()=>{e.hidePanel()})),e.dom.panel.addEventListener("click",(a=>{const n=a.target,s=n.nodeName.toLowerCase();if("a"===s&&n.rel)switch(event.preventDefault(),n.rel){case"prev":e.gotoPrev();break;case"next":e.gotoNext();break;case"today":e.hidePanel(),t.setDate((new Date).getTime());break;case"clear":e.hidePanel(),t.clearDate();break;case"confirm":e.hidePanel(),"range"===t.settings.mode?e.confirmRange():e.confirmTime()}else if("li"===s&&n.dataset.date){let a=n.dataset.date;if("string"!=typeof a||!a.length)return;for(let e of n.parentNode.parentNode.querySelectorAll("li"))e.classList.remove("selected");if(n.classList.add("selected"),"range"===t.settings.mode){const t=e.parseDate(a).getTime();return"number"!=typeof e.cacheDate.startTime||e.cacheDate.startTime>=t||"number"==typeof e.cacheDate.endTime?(e.cacheDate.startTime=t,delete e.cacheDate.endTime,void n.classList.add("start")):(e.cacheDate.endTime=t,void e.gotoDate())}if("datetime"===t.settings.type)return void(e.cacheDate.time=e.parseDate(a).getTime());e.hidePanel(),t.setDate(a)}})),e.dom.panel.addEventListener("change",(t=>{const a=t.target;"select"===a.nodeName.toLowerCase()&&["year","month"].indexOf(a.name)>=0&&e.gotoDate()}))},e.getSelects=function(e,t){const a=this,n={};for(let s of a.dom.head.querySelectorAll("select"))e.indexOf(s.name)>=0&&(n[s.name]=s,a.isObject(t)&&(t[s.name]=parseInt(s.value,10)));return n},e.buildPanel=function(){const e=this;t.settings.date?(e.cacheDate={time:t.defDate.time},"number"==typeof t.defDate.start&&"number"==typeof t.defDate.end&&(e.cacheDate.startTime=t.defDate.start,e.cacheDate.endTime=t.defDate.end)):e.cacheDate={},e.dom.head.innerHTML="",e.dom.main.innerHTML="";const a=["cxcalendar","m_"+t.settings.type];"range"===t.settings.mode&&a.push("range"),"string"==typeof t.settings.baseClass&&t.settings.baseClass.length&&a.push(t.settings.baseClass),e.dom.panel.className=a.join(" ");const n="<em></em>",s='<a class="prev" href="javascript://" rel="prev"></a><a class="next" href="javascript://" rel="next"></a>',i="range"===t.settings.mode?'<section class="fill"></section>':"";let o="<section>";if(["month","date","datetime"].indexOf(t.settings.type)>=0){o+='<select name="year" class="year">';for(let e=t.minDate.year;e<=t.maxDate.year;e++)o+='<option value="'+e+'">'+e+"</option>";o+="</select>"}else if("year"===t.settings.type){o+='<select name="year" class="year">';for(let e=10*Math.floor(t.minDate.year/10);e<=t.maxDate.year;e+=t.settings.yearNum){o+='<option value="'+e+'">'+e+" - ",o+=e+t.settings.yearNum-1,o+="</option>"}o+="</select>"}["date","datetime"].indexOf(t.settings.type)>=0?(o+=n,o+='<select name="month" class="month"></select>',o+=n,o+="</section>",o+=i,o+=s,e.dom.head.innerHTML=o,e.dom.dateSet.className="days",e.dom.main.insertAdjacentElement("beforeend",e.dom.dateSet),e.dom.panel.insertAdjacentElement("afterbegin",e.dom.head),"datetime"===t.settings.type&&e.buildTimes(),e.rebuildMonthSelect(),e.gotoDate([t.defDate.year,t.defDate.month].join("-"))):"time"===t.settings.type?(e.dom.panel.contains(e.dom.head)&&e.dom.panel.removeChild(e.dom.head),e.buildTimes()):"month"===t.settings.type?(o+=n,o+="</section>",o+=i,o+=s,e.dom.head.innerHTML=o,e.dom.dateSet.className="months",e.dom.main.insertAdjacentElement("beforeend",e.dom.dateSet),e.dom.panel.insertAdjacentElement("afterbegin",e.dom.head),e.gotoDate(t.defDate.year)):"year"===t.settings.type&&(o+="</section>",o+=i,o+=s,e.dom.head.innerHTML=o,e.dom.dateSet.className="years",e.dom.main.insertAdjacentElement("beforeend",e.dom.dateSet),e.dom.panel.insertAdjacentElement("afterbegin",e.dom.head),e.gotoDate(t.defDate.year)),e.buildActs()},e.buildActs=function(){const e=this,a=(new Date).getTime(),n=[];!1!==t.settings.button.today&&"range"!==t.settings.mode&&t.minDate.time<=a&&t.maxDate.time>=a&&n.push("today"),!1!==t.settings.button.clear&&n.push("clear"),("range"===t.settings.mode||["datetime","time"].indexOf(t.settings.type)>=0)&&n.push("confirm");let s="";for(let e of n)s+='<a class="'+e+'" href="javascript://" rel="'+e+'"></a>';s.length?(e.dom.acts.innerHTML=s,e.dom.panel.insertAdjacentElement("beforeend",e.dom.acts)):e.dom.panel.contains(e.dom.acts)&&e.dom.panel.removeChild(e.dom.acts)},e.rebuildMonthSelect=function(){const e={},a=this.getSelects(["year","month"],e);let n=1,s=12;e.year===t.minDate.year&&e.year===t.maxDate.year?(n=t.minDate.month,s=t.maxDate.month):e.year===t.minDate.year?n=t.minDate.month:e.year===t.maxDate.year&&(s=t.maxDate.month);let i="";for(let a=n;a<=s;a++)i+='<option value="'+a+'"',e.month===a&&(i+=" selected"),i+=">"+t.language.monthList[a-1]+"</option>";a.month.innerHTML=i},e.buildDays=function(e,a){const n=this;if(!n.isInteger(e)||!n.isInteger(a))return;const s=new Date(e,a-1,1);e=s.getFullYear(),a=s.getMonth()+1,(e<t.minDate.year||e===t.minDate.year&&a<t.minDate.month)&&(e=t.minDate.year,a=t.minDate.month);const i=a-1,o=n.getMonthDays(e),r=new Date(e,i,1),l=new Date,d=[l.getFullYear(),l.getMonth()+1,l.getDate()].join("-"),m=n.formatDate("Y-n-j",n.cacheDate.time);let c=r.getDay()-t.settings.weekStart;c<0&&(c+=7);const g=6-t.settings.weekStart,u=(7-t.settings.weekStart)%7;let h=t.settings.lockRow?42:7*Math.ceil((o[i]+c)/7);const p={};"number"==typeof n.cacheDate.startTime&&(p.start=parseInt(n.formatDate("Ymd",n.cacheDate.startTime),10),"number"==typeof n.cacheDate.endTime?p.end=parseInt(n.formatDate("Ymd",n.cacheDate.endTime),10):p.end=p.start);let f="<ul>";for(let e=0;e<7;e++)f+='<li class="week',e===g?f+=" sat":e===u&&(f+=" sun"),f+='">'+t.language.weekList[(e+t.settings.weekStart)%7]+"</li>";for(let s=0;s<h;s++){const r=[];let l=e,h=a,y=s-c+1;y<=0?(r.push("other"),h<=1?(l--,h=12,y=o[11]+y):(h--,y=o[i-1]+y)):y>o[i]&&(r.push("other"),h>=12?(l++,h=1,y-=o[0]):(h++,y-=o[i]));const D=new Date(l,h-1,y),b=D.getTime(),T=[l,h,y].join("-"),x=parseInt([l,n.fillLeadZero(h,2),n.fillLeadZero(y,2)].join(""),10);let v="";if("range"===t.settings.mode?(x===p.start||x===p.end||x>=p.start&&x<=p.end)&&(r.push("selected"),x===p.start&&r.push("start"),x===p.end&&r.push("end")):T===m&&r.push("selected"),T===d&&r.push("now"),s%7===g?r.push("sat"):s%7===u&&r.push("sun"),(b<t.minDate.time||b>t.maxDate.time||Array.isArray(t.settings.disableWeek)&&t.settings.disableWeek.length&&t.settings.disableWeek.indexOf((s+t.settings.weekStart)%7)>=0||Array.isArray(t.settings.disableDay)&&t.settings.disableDay.length&&(t.settings.disableDay.indexOf(String(y))>=0||t.settings.disableDay.indexOf([h,y].join("-"))>=0||t.settings.disableDay.indexOf([l,h,y].join("-"))>=0))&&r.push("del"),t.holiday){const e=[[l,h,y].join("-"),[h,y].join("-")];for(let a of e)if("string"==typeof t.holiday[a]){r.push("holiday"),v=t.holiday[a];break}}f+="<li",r.length&&(f+=' class="'+r.join(" ")+'"'),-1===r.indexOf("del")&&(f+=' data-date="'+T+'"'),v.length&&(f+=' data-title="'+v+'"'),s%7==0&&(f+=' data-week-num="'+n.getWeekNum(D)+'"'),f+=">"+y+"</li>"}return f+="</ul>",f},e.buildTimes=function(){const e=this,a="<i></i>";let n,s="<section>";s+='<select name="hour" class="hour">';for(let a=0;a<24;a+=t.settings.hourStep)n=e.fillLeadZero(a,2),s+='<option value="'+n+'">'+n+"</option>";s+="</select>",s+=a,s+='<select name="mint" class="mint">';for(let a=0;a<60;a+=t.settings.minuteStep)n=e.fillLeadZero(a,2),s+='<option value="'+n+'">'+n+"</option>";s+="</select>",s+=a,s+='<select name="secs" class="secs">';for(let a=0;a<60;a+=t.settings.secondStep)n=e.fillLeadZero(a,2),s+='<option value="'+n+'">'+n+"</option>";s+="</select>",s+="</section>","range"===t.settings.mode&&(s+=s),e.dom.timeSet.innerHTML=s,e.dom.main.insertAdjacentElement("beforeend",e.dom.timeSet),e.setTimesValues()},e.setTimesValues=function(){const e=this,a=[];e.cacheDate.startTime&&e.cacheDate.endTime?a.push(e.cacheDate.startTime,e.cacheDate.endTime):e.cacheDate.startTime?a.push(e.cacheDate.startTime,e.cacheDate.startTime):a.push(t.defDate.time,t.defDate.time);const n={hour:[],mint:[],secs:[]};for(let t of a){const a=new Date(t);n.hour.push(e.fillLeadZero(a.getHours(),2)),n.mint.push(e.fillLeadZero(a.getMinutes(),2)),n.secs.push(e.fillLeadZero(a.getSeconds(),2))}for(let t of e.dom.timeSet.querySelectorAll("select"))n[t.name]&&n[t.name].length&&(t.value=n[t.name].shift())},e.buildMonths=function(e){const a=this;if(!a.isInteger(e))return;const n=new Date,s=[n.getFullYear(),n.getMonth()+1].join("-"),i=a.formatDate("Y-n",a.cacheDate.time),o={};"number"==typeof a.cacheDate.startTime&&(o.start=parseInt(a.formatDate("Ym",a.cacheDate.startTime),10),"number"==typeof a.cacheDate.endTime?o.end=parseInt(a.formatDate("Ym",a.cacheDate.endTime),10):o.end=o.start);let r="<ul>";for(let n=1;n<=12;n++){const l=[],d=e+"-"+n,m=parseInt(e+a.fillLeadZero(n,2),10);"range"===t.settings.mode?(m===o.start||m===o.end||m>=o.start&&m<=o.end)&&(l.push("selected"),m===o.start&&l.push("start"),m===o.end&&l.push("end")):d===i&&l.push("selected"),d===s&&l.push("now"),(e<t.minDate.year||e>t.maxDate.year||e===t.minDate.year&&n<t.minDate.month||e===t.maxDate.year&&n>t.maxDate.month)&&l.push("del"),r+="<li",l.length&&(r+=' class="'+l.join(" ")+'"'),-1===l.indexOf("del")&&(r+=' data-date="'+d+'"'),r+=">"+t.language.monthList[n-1]+"</li>"}return r+="</ul>",r},e.buildYears=function(e){const a=this;let n,s,i=t.minDate.year;if(!a.isInteger(e))return;const o=(new Date).getFullYear(),r=parseInt(a.formatDate("Y",a.cacheDate.time),10);e<t.minDate.year&&(i=t.minDate.year),i=10*Math.floor(i/10),s=e-i,s>=t.settings.yearNum&&(i+=Math.floor(s/t.settings.yearNum)*t.settings.yearNum),n=i+t.settings.yearNum-1;const l={};"number"==typeof a.cacheDate.startTime&&(l.start=parseInt(a.formatDate("Y",a.cacheDate.startTime),10),"number"==typeof a.cacheDate.endTime?l.end=parseInt(a.formatDate("Y",a.cacheDate.endTime),10):l.start=l.end);let d="<ul>";for(let e=i;e<=n;e++){const a=[];"range"===t.settings.mode?(e===l.start||e===l.end||e>=l.start&&e<=l.end)&&(a.push("selected"),e===l.start&&a.push("start"),e===l.end&&a.push("end")):e===r&&a.push("selected"),e===o&&a.push("now"),(e<t.minDate.year||e>t.maxDate.year)&&a.push("del"),d+="<li",a.length&&(d+=' class="'+a.join(" ")+'"'),-1===a.indexOf("del")&&(d+=' data-date="'+e+'"'),d+=">"+e+"</li>"}return d+="</ul>",d},e.gotoDate=function(e){const a=this,n={},s=a.getSelects(["year","month"],n);void 0===e&&(e=n.year,n.month&&(e+="-"+n.month));const i=a.parseDate(e,!0),o=i.getTime();o<t.minDate.time?i.setTime(t.minDate.time):o>t.maxDate.time&&i.setTime(t.maxDate.time);let r=i.getFullYear(),l=i.getMonth()+1;if("year"===t.settings.type){let e=r;for(let t of s.year.options){let a=parseInt(t.value,10);if(!(a<=r))break;e=a}r=e,e!==n.year&&(s.year.value=e)}else r!==n.year&&(s.year.value=r);s.month&&(r===n.year&&l===n.month||(a.rebuildMonthSelect(),s.month.value=l));const d={start:!0,end:!0};for(let e in s)0!==s[e].selectedIndex&&(d.start=!1),s[e].selectedIndex!==s[e].length-1&&(d.end=!1);for(let e in d)d[e]?a.dom.panel.classList.add("at_"+e):a.dom.panel.classList.contains("at_"+e)&&a.dom.panel.classList.remove("at_"+e);let m="",c="";switch(t.settings.type){case"date":case"datetime":if(m=a.buildDays(r,l),"range"===t.settings.mode){let e=l+1;e>12&&(e=1),c='<span class="year">'+r+"</span><em></em>",c+='<span class="month">'+t.language.monthList[e-1]+"</span><em></em>",m+=a.buildDays(r,l+1)}break;case"month":m=a.buildMonths(r),"range"===t.settings.mode&&(c='<span class="year">'+(r+1)+"</span><em></em>",m+=a.buildMonths(r+1));break;case"year":m=a.buildYears(r),"range"===t.settings.mode&&(c='<span class="year">'+(r+t.settings.yearNum)+" - "+(r+2*t.settings.yearNum-1)+"</span>",m+=a.buildYears(r+t.settings.yearNum))}if(a.dom.dateSet.innerHTML=m,"range"===t.settings.mode){let e=a.dom.head.querySelectorAll("section");e.length>1&&(e[1].innerHTML=c)}},e.gotoPrev=function(){const e=this,a=e.getSelects(["year","month"]);switch(t.settings.type){case"date":case"datetime":const t=a.month.selectedIndex;t>0?(a.month.selectedIndex-=1,e.gotoDate()):0===t&&a.year.selectedIndex>0&&(a.year.selectedIndex-=1,e.rebuildMonthSelect(),a.month.selectedIndex=a.month.length-1,e.gotoDate());break;case"month":case"year":a.year.selectedIndex>0&&(a.year.selectedIndex-=1,e.gotoDate())}},e.gotoNext=function(){const e=this,a=e.getSelects(["year","month"]);switch(t.settings.type){case"date":case"datetime":const t=a.month.selectedIndex,n=a.month.length-1;t<n?(a.month.selectedIndex+=1,e.gotoDate()):t===n&&a.year.selectedIndex<a.year.length-1&&(a.year.selectedIndex+=1,e.rebuildMonthSelect(),a.month.selectedIndex=0,e.gotoDate());break;case"month":case"year":a.year.selectedIndex<a.year.length-1&&(a.year.selectedIndex+=1,e.gotoDate())}},e.showPanel=function(){const e=this;e.delayHide&&clearTimeout(e.delayHide);const a=t.settings.position,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=t.input.getBoundingClientRect(),o=i.width,r=i.height,l=i.top,d=i.left,m=l+window.pageYOffset-document.documentElement.clientTop,c=d+window.pageXOffset-document.documentElement.clientLeft,g=e.dom.panel.getBoundingClientRect(),u=g.width,h=g.height;let p=l+r+h>s&&m-h>=0?m-h:m+r,f=d+u>n&&c-u>=0?c-u+o:c;if("string"==typeof a&&a.length)switch(a){case"fixed":p=null,f=null;break;case"top":p=m-h;break;case"bottom":p=m+r;break;case"left":case"right":p=l+r+h>s?m+r-h:m,f="left"===a?c-u:c+o}"number"==typeof p&&"number"==typeof f&&(e.dom.panel.style.top=p+"px",e.dom.panel.style.left=f+"px"),e.dom.panel.classList.add("show")},e.hidePanel=function(){const e=this;e.dom.panel.classList.remove("show"),e.delayHide=setTimeout((()=>{e.dom.panel.removeAttribute("style")}),300)},e.confirmRange=function(){const e=this;let a=[];if(e.cacheDate.startTime&&e.cacheDate.endTime?a.push(e.cacheDate.startTime,e.cacheDate.endTime):e.cacheDate.startTime?a.push(e.cacheDate.startTime,e.cacheDate.startTime):a.push(t.defDate.time,t.defDate.time),["datetime","time"].indexOf(t.settings.type)>=0){const n={hour:[],mint:[],secs:[]};for(let t of e.dom.timeSet.querySelectorAll("select"))n[t.name]&&n[t.name].push(t.value);if("datetime"===t.settings.type){const e=[];for(let t=0,s=a.length;t<s;t++)e.push(parseInt([1,n.hour[t],n.mint[t],n.secs[t]].join(""),10));if(e[0]>e[1])for(let e in n)n[e].length>1&&(n[e][1]=n[e][0])}a=a.map(((e,t)=>{const a=new Date(e);return a.setHours(n.hour[t],n.mint[t],n.secs[t],0),a.getTime()}))}a=a.join(t.settings.rangeSymbol),t.setDate(a)},e.confirmTime=function(){const e=this,a=new Date;let n=t.defDate.time;"datetime"===t.settings.type&&"number"==typeof e.cacheDate.time&&(n=e.cacheDate.time),a.setTime(n);const s=Array(4).fill(0),i={hour:0,mint:1,secs:2};for(let t of e.dom.timeSet.querySelectorAll("select"))t.name in i&&(s[i[t.name]]=parseInt(t.value));a.setHours(...s),t.setDate(a.getTime())},e.detach=function(e){const t=this;if(!t.isElement(e))return;const a="id_"+e.dataset.cxCalendarId;delete e.dataset.cxCalendarId,"function"==typeof t.bindFuns[a]&&(e.removeEventListener("click",t.bindFuns[a]),delete t.bindFuns[a])},document.addEventListener("DOMContentLoaded",(()=>{e.init()}));const a=function(){const t=this;let a={},s=!1;for(let n of arguments)e.isElement(n)?t.input=n:e.isObject(n)?a=n:"boolean"==typeof n&&(s=n);if(!t.input||!t.input.nodeName||-1===["input","textarea"].indexOf(t.input.nodeName.toLowerCase()))return void console.warn("[cxCalendar] Not input element.");const i={baseClass:"baseClass",disableWeek:"disableWeek",disableDay:"disableDay",endDate:"endDate",format:"format",hourStep:"hourStep",language:"language",lockRow:"lockRow",minuteStep:"minuteStep",position:"position",mode:"mode",rangeSymbol:"rangeSymbol",secondStep:"secondStep",startDate:"startDate",type:"type",weekStart:"weekStart",yearNum:"yearNum"},o={};for(let e in i)"string"==typeof t.input.dataset[i[e]]&&t.input.dataset[i[e]].length&&("lockRow"===e?o[e]=Boolean(parseInt(t.input.dataset[i[e]],10)):["disableWeek","disableDay"].indexOf(e)>=0?o[e]=t.input.dataset[i[e]].split(","):o[e]=t.input.dataset[i[e]]);Array.isArray(o.disableWeek)&&o.disableWeek.forEach((e=>{})),t.settings=e.extend({},n.defaults,a,o),t.setOptions();let r="id_"+t.input.dataset.cxCalendarId;"function"==typeof e.bindFuns[r]&&t.detach(t.input),t.eventChange=new CustomEvent("change",{bubbles:!0}),s?(t.input.dataset.cxCalendarId=e.cxId,r="id_"+e.cxId,e.cxId++,e.bindFuns[r]=t.show.bind(t),t.input.addEventListener("click",e.bindFuns[r])):t.show()};a.prototype.setOptions=function(t){const a=this;let n,s,i;e.isObject(t)&&e.extend(a.settings,t),n=e.reg.isYear.test(a.settings.endDate)?new Date(a.settings.endDate,11,31):e.parseDate(a.settings.endDate,!0),n.setHours(23,59,59),a.maxDate={year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate(),time:n.getTime()},s=e.reg.isYear.test(a.settings.startDate)?new Date(a.settings.startDate,0,1):e.parseDate(a.settings.startDate),e.isDate(s)||(s=new Date,s.setFullYear(s.getFullYear()-1)),s.getTime()>a.maxDate.time&&(s=new Date(a.maxDate.year-1,a.maxDate.month-1,a.maxDate.day)),s.setHours(0,0,0,0),a.minDate={year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate(),time:s.getTime()};const o={};if("range"===a.settings.mode){const t=String(a.settings.date).split(a.settings.rangeSymbol);if(2===t.length){i=e.parseDate(t[0],!0);const a=e.parseDate(t[1],!0);o.start=i.getTime(),o.end=a.getTime()}}if(i||(i=e.parseDate(a.settings.date,!0)),i.getTime()<a.minDate.time?i=e.parseDate(a.minDate.time,!0):i.getTime()>a.maxDate.time&&(i=e.parseDate(a.maxDate.time,!0)),a.defDate={year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate(),hour:i.getHours(),mint:i.getMinutes(),secs:i.getSeconds(),time:i.getTime(),start:o.start,end:o.end},a.settings.weekStart%=7,a.language=e.getLanguage(a.settings.language),Array.isArray(a.language.holiday)&&a.language.holiday.length){a.holiday={};for(let e of a.language.holiday)a.holiday[e.day]=e.name}else a.holiday=null},a.prototype.show=function(){const a=this;!a.input.value&&a.settings.date||(a.settings.date=a.input.value),a.setOptions(),t=a,e.buildPanel(),e.showPanel()},a.prototype.hide=function(){e.hidePanel()},a.prototype.getDate=function(t){const a=this,n=a.input.value,s=[];if("string"==typeof t&&t.length||(t=a.settings.format),"range"===a.settings.mode){const e=String(n).split(a.settings.rangeSymbol);2===e.length&&s.push(...e)}else s.push(n);let i=[];for(let a of s){const n=e.parseDate(a);if(!e.isDate(n)){i=[];break}i.push(e.formatDate(t,n.getTime()))}return i="range"===a.settings.mode?i.join(a.settings.rangeSymbol):i.join(""),i},a.prototype.setDate=function(t){const a=this,n=a.input.value,s=[];if("range"===a.settings.mode){const e=String(t).split(a.settings.rangeSymbol);2===e.length&&s.push(...e)}else s.push(t);let i=[];for(let t of s){const n=e.parseDate(t);if(!e.isDate(n)){i=[];break}let s=n.getTime();s<a.minDate.time?s=a.minDate.time:s>a.maxDate.time&&(s=a.maxDate.time),i.push(e.formatDate(a.settings.format,s))}i="range"===a.settings.mode?i.join(a.settings.rangeSymbol):i.join(""),n!==i&&(a.input.value=i,a.input.dispatchEvent(a.eventChange))},a.prototype.clearDate=function(){const e=this,t=e.input.value;t&&t.length&&(e.input.value="",e.input.dispatchEvent(e.eventChange))};const n=function(e,t,n){const s=new a(...arguments);if(n)return s};return n.attach=function(e,t){return this(e,t,!0)},n.detach=function(t){e.detach(t)},n.defaults={startDate:void 0,endDate:void 0,date:void 0,type:"date",format:"Y-m-d",weekStart:0,lockRow:!1,yearNum:20,hourStep:1,minuteStep:1,secondStep:1,disableWeek:[],disableDay:[],mode:"single",rangeSymbol:" - ",button:{},position:void 0,baseClass:void 0,language:void 0},n.languages={default:{am:"上午",pm:"下午",monthList:["1","2","3","4","5","6","7","8","9","10","11","12"],weekList:["日","一","二","三","四","五","六"],holiday:[]}},n}));
