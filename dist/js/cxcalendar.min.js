/**
 * cxCalendar
 * @version 3.0.4
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxCalendar
 * @license Released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cxCalendar=t()}(this,(function(){"use strict";const e={dom:{},reg:{isYear:/^\d{4}$/,isTime:/^\d{1,2}(\:\d{1,2}){1,2}$/},cxId:1,bindFuns:{},cacheDate:{},cacheApi:null,language:{am:"上午",pm:"下午",monthList:["1","2","3","4","5","6","7","8","9","10","11","12"],weekList:["日","一","二","三","四","五","六"]},isElement:e=>!(!e||"function"!=typeof HTMLElement&&"object"!=typeof HTMLElement||!(e instanceof HTMLElement))||!(!e||!e.nodeType||1!==e.nodeType),isInteger:e=>("string"==typeof e&&/^\-?\d+$/.test(e)&&(e=parseInt(e,10)),"number"==typeof e&&isFinite(e)),isObject:e=>null!=e&&"[object Object]"===Object.prototype.toString.call(e)&&!(e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf")),isDate:e=>(e instanceof Date||"[object Date]"===Object.prototype.toString.call(e))&&isFinite(e.getTime()),extend:function(e,...t){const a=this;if(a.isObject(e)){for(let n of t)if(a.isObject(n))for(let t in n)Array.isArray(n[t])?e[t]=[].concat(n[t]):a.isObject(n[t])?(a.isObject(e[t])||(e[t]={}),a.extend(e[t],n[t])):e[t]=n[t];return e}},fillLeadZero:function(e,t){let a=String(e);return a.length<t&&(a=Array(t-a.length).fill(0).join("")+e),a},getMonthDays:function(e){return[31,28+(e%4==0&&e%100!=0||e%400==0?1:0),31,30,31,30,31,31,30,31,30,31]},getWeekNum:function(e){const t=this,a=e.getTime(),n=new Date(e.getFullYear(),0,1,0,0,0,0);let i=n.getTime(),s=n.getDay(),c=0;return 0===s&&(s=7),i+=s>4?864e5*(8-s):864e5*(1-s),a<i?c=t.getWeekNum(new Date(e.getFullYear()-1,11,31)):(c=Math.floor((a-i)/864e5)+1,c=Math.ceil(c/7)),c},parseDate:function(e,t){const a=this;let n=new Date;if(a.reg.isYear.test(e))n.setFullYear(parseInt(e,10));else if(a.isInteger(e))n.setTime(parseInt(e,10));else if("string"==typeof e&&e.length){let t;a.reg.isTime.test(e)?(t=e.split(":").map((e=>parseInt(e,10))),t.length<4?t=t.concat(Array(4-t.length).fill(0)):t.length>4&&(t.length=4),n.setHours.apply(n,t)):(e=e.replace(/[\.\/]/g,"-"),/^\d{1,2}-\d{1,2}/.test(e)?e=n.getFullYear()+"-"+e:/^\d{4}-\d{1,2}$/.test(e)&&(e+="-1"),t=e.split(/[\-\sT\:]/).map((e=>parseInt(e,10))),t.length>1&&(t[1]-=1),t.length<7?t=t.concat(Array(7-t.length).fill(0)):t.length>7&&(t.length=7),n.setFullYear.apply(n,t.slice(0,3)),n.setHours.apply(n,t.slice(3)))}else n=null;return!0!==t||a.isDate(n)||(n=new Date),n},formatDate:function(e,t,a){const n=this,i=n.parseDate(t),s=n.extend({},n.language);if(n.isObject(a)&&n.extend(s,a),"string"!=typeof e||!n.isDate(i))return t;const c={Y:i.getFullYear(),n:i.getMonth()+1,j:i.getDate(),G:i.getHours(),timestamp:i.getTime()};c.y=c.Y.toString(10).slice(-2),c.m=n.fillLeadZero(c.n,2),c.d=n.fillLeadZero(c.j,2),c.W=n.getWeekNum(i),c.H=n.fillLeadZero(c.G,2),c.g=c.G>12?c.G-12:c.G,c.h=n.fillLeadZero(c.g,2),c.i=n.fillLeadZero(i.getMinutes(),2),c.s=n.fillLeadZero(i.getSeconds(),2),c.a=c.G>12?s.pm:s.am;const o=["timestamp","Y","y","m","n","d","j","W","H","h","G","g","i","s","a"],r=new RegExp("("+o.join("|")+")","g");let l=e;l=l.replace(/([\{\}])/g,"\\$1"),l=l.replace(r,((e,t)=>"{{"+t+"}}")),l=l.replace(/\\\{\{(.)\}\}/g,"$1");for(let e of o)l=l.replace(new RegExp("{{"+e+"}}","g"),c[e]);return l=l.replace(/\\(.)/g,"$1"),l},getLanguage:function(e){const t=this,a={};return t.isObject(e)?t.extend(a,t.language,e):("string"==typeof e&&e.length||("string"==typeof navigator.language?e=navigator.language:"string"==typeof navigator.browserLanguage&&(e=navigator.browserLanguage)),"string"==typeof e&&e.length&&window.cxCalendar&&t.isObject(window.cxCalendar.languages)&&(e=e.toLowerCase(),t.isObject(window.cxCalendar.languages[e])?t.extend(a,window.cxCalendar.languages[e]):t.isObject(window.cxCalendar.languages.default)&&t.extend(a,window.cxCalendar.languages.default)),Object.keys(a).length||t.extend(a,t.language),a)},init:function(){this.buildStage(),this.bindEvent()},buildStage:function(){const e=this;e.dom.maskBg=document.createElement("div"),e.dom.maskBg.classList.add("cxcalendar_mask"),e.dom.panel=document.createElement("div"),e.dom.panel.classList.add("cxcalendar"),e.dom.head=document.createElement("div"),e.dom.head.classList.add("cxcalendar_hd"),e.dom.main=document.createElement("div"),e.dom.main.classList.add("cxcalendar_bd"),e.dom.acts=document.createElement("div"),e.dom.acts.classList.add("cxcalendar_acts"),e.dom.dateSet=document.createElement("div"),e.dom.timeSet=document.createElement("div"),e.dom.timeSet.classList.add("times"),e.dom.panel.insertAdjacentElement("beforeend",e.dom.main),document.body.insertAdjacentElement("beforeend",e.dom.panel),e.dom.panel.insertAdjacentElement("afterend",e.dom.maskBg)},bindEvent:function(){const e=this;e.dom.maskBg.addEventListener("click",(()=>{e.hidePanel()})),e.dom.panel.addEventListener("click",(t=>{const a=t.target,n=a.nodeName.toLowerCase();if("a"===n&&a.rel)switch(event.preventDefault(),a.rel){case"prev":e.gotoPrev();break;case"next":e.gotoNext();break;case"today":e.hidePanel(),e.cacheApi.setDate((new Date).getTime());break;case"clear":e.hidePanel(),e.cacheApi.clearDate();break;case"confirm":e.hidePanel(),"range"===e.cacheApi.settings.mode?e.confirmRange():e.confirmTime()}else if("li"===n&&a.dataset.date){const t=a.dataset.date;if("string"!=typeof t||!t.length)return;for(let e of a.parentNode.parentNode.querySelectorAll("li"))e.classList.remove("selected");if(a.classList.add("selected"),"range"===e.cacheApi.settings.mode){const a=e.parseDate(t);a.setHours(0,0,0,0);const n=a.getTime();return"number"==typeof e.cacheDate.startTime&&"number"==typeof e.cacheDate.endTime?n>=e.cacheDate.startTime&&n<=e.cacheDate.endTime?(delete e.cacheDate.startTime,delete e.cacheDate.endTime):(e.cacheDate.startTime=n,delete e.cacheDate.endTime):"number"==typeof e.cacheDate.startTime?n===e.cacheDate.startTime?delete e.cacheDate.startTime:n>e.cacheDate.startTime?e.cacheDate.endTime=n:e.cacheDate.startTime=n:e.cacheDate.startTime=n,void e.gotoDate()}if("datetime"===e.cacheApi.settings.type)return void(e.cacheDate.time=e.parseDate(t).getTime());e.hidePanel(),e.cacheApi.setDate(t)}})),e.dom.panel.addEventListener("change",(t=>{const a=t.target;"select"===a.nodeName.toLowerCase()&&["year","month"].indexOf(a.name)>=0&&e.gotoDate()}))},getSelects:function(e,t){const a=this,n={};for(let i of a.dom.head.querySelectorAll("select"))e.indexOf(i.name)>=0&&(n[i.name]=i,a.isObject(t)&&(t[i.name]=parseInt(i.value,10)));return n},buildPanel:function(){const e=this;e.cacheApi.settings.date?(e.cacheDate={time:e.cacheApi.defDate.time},"number"==typeof e.cacheApi.defDate.start&&"number"==typeof e.cacheApi.defDate.end&&(e.cacheDate.startTime=e.cacheApi.defDate.start,e.cacheDate.endTime=e.cacheApi.defDate.end)):e.cacheDate={},e.dom.head.innerHTML="",e.dom.main.innerHTML="";const t=["cxcalendar","m_"+e.cacheApi.settings.type];"range"===e.cacheApi.settings.mode&&t.push("range"),"string"==typeof e.cacheApi.settings.baseClass&&e.cacheApi.settings.baseClass.length&&t.push(e.cacheApi.settings.baseClass),e.dom.panel.className=t.join(" ");const a="<em></em>",n='<a class="prev" href="javascript://" rel="prev"></a><a class="next" href="javascript://" rel="next"></a>',i="range"===e.cacheApi.settings.mode?'<section class="fill"></section>':"";let s="<section>";if(["month","date","datetime"].indexOf(e.cacheApi.settings.type)>=0){s+='<select name="year" class="year">';for(let t=e.cacheApi.minDate.year;t<=e.cacheApi.maxDate.year;t++)s+='<option value="'+t+'">'+t+"</option>";s+="</select>"}else if("year"===e.cacheApi.settings.type){s+='<select name="year" class="year">';for(let t=10*Math.floor(e.cacheApi.minDate.year/10);t<=e.cacheApi.maxDate.year;t+=e.cacheApi.settings.yearNum){s+='<option value="'+t+'">'+t+" - ",s+=t+e.cacheApi.settings.yearNum-1,s+="</option>"}s+="</select>"}["date","datetime"].indexOf(e.cacheApi.settings.type)>=0?(s+=a,s+='<select name="month" class="month"></select>',s+=a,s+="</section>",s+=i,s+=n,e.dom.head.innerHTML=s,e.dom.dateSet.className="days",e.dom.main.insertAdjacentElement("beforeend",e.dom.dateSet),e.dom.panel.insertAdjacentElement("afterbegin",e.dom.head),"datetime"===e.cacheApi.settings.type&&e.buildTimes(),e.rebuildMonthSelect(),e.gotoDate([e.cacheApi.defDate.year,e.cacheApi.defDate.month].join("-"))):"time"===e.cacheApi.settings.type?(e.dom.panel.contains(e.dom.head)&&e.dom.panel.removeChild(e.dom.head),e.buildTimes()):"month"===e.cacheApi.settings.type?(s+=a,s+="</section>",s+=i,s+=n,e.dom.head.innerHTML=s,e.dom.dateSet.className="months",e.dom.main.insertAdjacentElement("beforeend",e.dom.dateSet),e.dom.panel.insertAdjacentElement("afterbegin",e.dom.head),e.gotoDate(e.cacheApi.defDate.year)):"year"===e.cacheApi.settings.type&&(s+="</section>",s+=i,s+=n,e.dom.head.innerHTML=s,e.dom.dateSet.className="years",e.dom.main.insertAdjacentElement("beforeend",e.dom.dateSet),e.dom.panel.insertAdjacentElement("afterbegin",e.dom.head),e.gotoDate(e.cacheApi.defDate.year)),e.buildActs()},buildActs:function(){const e=this,t=(new Date).getTime(),a=[];!1!==e.cacheApi.settings.button.today&&"range"!==e.cacheApi.settings.mode&&e.cacheApi.minDate.time<=t&&e.cacheApi.maxDate.time>=t&&a.push("today"),!1!==e.cacheApi.settings.button.clear&&a.push("clear"),("range"===e.cacheApi.settings.mode||["datetime","time"].indexOf(e.cacheApi.settings.type)>=0)&&a.push("confirm");let n="";for(let e of a)n+='<a class="'+e+'" href="javascript://" rel="'+e+'"></a>';n.length?(e.dom.acts.innerHTML=n,e.dom.panel.insertAdjacentElement("beforeend",e.dom.acts)):e.dom.panel.contains(e.dom.acts)&&e.dom.panel.removeChild(e.dom.acts)},rebuildMonthSelect:function(){const e=this,t={},a=e.getSelects(["year","month"],t);let n=1,i=12;t.year===e.cacheApi.minDate.year&&t.year===e.cacheApi.maxDate.year?(n=e.cacheApi.minDate.month,i=e.cacheApi.maxDate.month):t.year===e.cacheApi.minDate.year?n=e.cacheApi.minDate.month:t.year===e.cacheApi.maxDate.year&&(i=e.cacheApi.maxDate.month);let s="";for(let a=n;a<=i;a++)s+='<option value="'+a+'"',t.month===a&&(s+=" selected"),s+=">"+e.cacheApi.settings.language.monthList[a-1]+"</option>";a.month.innerHTML=s},buildDays:function(e,t){const a=this;if(!a.isInteger(e)||!a.isInteger(t))return;const n=new Date(e,t-1,1);e=n.getFullYear(),t=n.getMonth()+1,(e<a.cacheApi.minDate.year||e===a.cacheApi.minDate.year&&t<a.cacheApi.minDate.month)&&(e=a.cacheApi.minDate.year,t=a.cacheApi.minDate.month);const i=t-1,s=a.getMonthDays(e),c=new Date(e,i,1),o=new Date,r=[o.getFullYear(),o.getMonth()+1,o.getDate()].join("-"),l=a.formatDate("Y-n-j",a.cacheDate.time);let d=c.getDay()-a.cacheApi.settings.weekStart;d<0&&(d+=7);const m=6-a.cacheApi.settings.weekStart,h=(7-a.cacheApi.settings.weekStart)%7,p=a.cacheApi.settings.lockRow?42:7*Math.ceil((s[i]+d)/7),g={};let u=0;"number"==typeof a.cacheDate.startTime&&(g.start=parseInt(a.formatDate("Ymd",a.cacheDate.startTime),10),"number"==typeof a.cacheApi.settings.rangeMaxDay&&a.cacheApi.settings.rangeMaxDay&&(u=a.cacheDate.startTime+864e5*a.cacheApi.settings.rangeMaxDay),"number"==typeof a.cacheDate.endTime?g.end=parseInt(a.formatDate("Ymd",a.cacheDate.endTime),10):g.end=g.start);let f="<ul>";for(let e=0;e<7;e++)f+='<li class="week',e===m?f+=" sat":e===h&&(f+=" sun"),f+='">'+a.cacheApi.settings.language.weekList[(e+a.cacheApi.settings.weekStart)%7]+"</li>";for(let n=0;n<p;n++){const c=[];let o=e,p=t,y=n-d+1;y<=0?(c.push("other"),p<=1?(o--,p=12,y=s[11]+y):(p--,y=s[i-1]+y)):y>s[i]&&(c.push("other"),p>=12?(o++,p=1,y-=s[0]):(p++,y-=s[i]));const D=new Date(o,p-1,y),A=D.getTime(),b=[o,p,y].join("-"),x=parseInt([o,a.fillLeadZero(p,2),a.fillLeadZero(y,2)].join(""),10);let T="";if("range"===a.cacheApi.settings.mode?(x===g.start||x===g.end||x>=g.start&&x<=g.end)&&(c.push("selected"),x===g.start&&c.push("start"),x===g.end&&c.push("end")):b===l&&c.push("selected"),b===r&&c.push("now"),n%7===m?c.push("sat"):n%7===h&&c.push("sun"),(u&&A>u||A<a.cacheApi.minDate.time||A>a.cacheApi.maxDate.time||Array.isArray(a.cacheApi.settings.disableWeek)&&a.cacheApi.settings.disableWeek.length&&a.cacheApi.settings.disableWeek.indexOf((n+a.cacheApi.settings.weekStart)%7)>=0||Array.isArray(a.cacheApi.settings.disableDay)&&a.cacheApi.settings.disableDay.length&&(a.cacheApi.settings.disableDay.indexOf(String(y))>=0||a.cacheApi.settings.disableDay.indexOf([p,y].join("-"))>=0||a.cacheApi.settings.disableDay.indexOf([o,p,y].join("-"))>=0))&&c.push("del"),a.cacheApi.holiday){const e=[[o,p,y].join("-"),[p,y].join("-")];for(let t of e)if("string"==typeof a.cacheApi.holiday[t]){c.push("holiday"),T=a.cacheApi.holiday[t];break}}f+="<li",c.length&&(f+=' class="'+c.join(" ")+'"'),-1===c.indexOf("del")&&(f+=' data-date="'+b+'"'),T.length&&(f+=' data-title="'+T+'"'),n%7==0&&(f+=' data-week-num="'+a.getWeekNum(D)+'"'),f+=">"+y+"</li>"}return f+="</ul>",f},buildTimes:function(){const e=this,t="<i></i>";let a="<section>";a+='<select name="hour" class="hour">';for(let t=0;t<24;t+=e.cacheApi.settings.hourStep){const n=e.fillLeadZero(t,2);a+='<option value="'+n+'">'+n+"</option>"}a+="</select>",a+=t,a+='<select name="mint" class="mint">';for(let t=0;t<60;t+=e.cacheApi.settings.minuteStep){const n=e.fillLeadZero(t,2);a+='<option value="'+n+'">'+n+"</option>"}a+="</select>",a+=t,a+='<select name="secs" class="secs">';for(let t=0;t<60;t+=e.cacheApi.settings.secondStep){const n=e.fillLeadZero(t,2);a+='<option value="'+n+'">'+n+"</option>"}a+="</select>",a+="</section>","range"===e.cacheApi.settings.mode&&(a+=a),e.dom.timeSet.innerHTML=a,e.dom.main.insertAdjacentElement("beforeend",e.dom.timeSet),e.setTimesValues()},setTimesValues:function(){const e=this,t=[];e.cacheDate.startTime&&e.cacheDate.endTime?t.push(e.cacheDate.startTime,e.cacheDate.endTime):e.cacheDate.startTime?t.push(e.cacheDate.startTime,e.cacheDate.startTime):t.push(e.cacheApi.defDate.time,e.cacheApi.defDate.time);const a={hour:[],mint:[],secs:[]};for(let n of t){const t=new Date(n);a.hour.push(e.fillLeadZero(t.getHours(),2)),a.mint.push(e.fillLeadZero(t.getMinutes(),2)),a.secs.push(e.fillLeadZero(t.getSeconds(),2))}for(let t of e.dom.timeSet.querySelectorAll("select"))a[t.name]&&a[t.name].length&&(t.value=a[t.name].shift())},buildMonths:function(e){const t=this;if(!t.isInteger(e))return;const a=new Date,n=[a.getFullYear(),a.getMonth()+1].join("-"),i=t.formatDate("Y-n",t.cacheDate.time),s=parseInt(t.cacheApi.maxDate.year+t.fillLeadZero(t.cacheApi.maxDate.month,2),10),c=parseInt(t.cacheApi.minDate.year+t.fillLeadZero(t.cacheApi.minDate.month,2),10),o={};let r=0;if("number"==typeof t.cacheDate.startTime){if(o.start=parseInt(t.formatDate("Ym",t.cacheDate.startTime),10),"number"==typeof t.cacheApi.settings.rangeMaxMonth&&t.cacheApi.settings.rangeMaxMonth){const e=new Date(t.cacheDate.startTime);e.setMonth(e.getMonth()+t.cacheApi.settings.rangeMaxMonth),r=parseInt(t.formatDate("Ym",e.getTime()),10)}"number"==typeof t.cacheDate.endTime?o.end=parseInt(t.formatDate("Ym",t.cacheDate.endTime),10):o.end=o.start}let l="<ul>";for(let a=1;a<=12;a++){const d=[],m=e+"-"+a,h=parseInt(e+t.fillLeadZero(a,2),10);"range"===t.cacheApi.settings.mode?(h===o.start||h===o.end||h>=o.start&&h<=o.end)&&(d.push("selected"),h===o.start&&d.push("start"),h===o.end&&d.push("end")):m===i&&d.push("selected"),m===n&&d.push("now"),(r&&h>r||h<c||h>s)&&d.push("del"),l+="<li",d.length&&(l+=' class="'+d.join(" ")+'"'),-1===d.indexOf("del")&&(l+=' data-date="'+m+'"'),l+=">"+t.cacheApi.settings.language.monthList[a-1]+"</li>"}return l+="</ul>",l},buildYears:function(e){const t=this;let a,n,i=t.cacheApi.minDate.year;if(!t.isInteger(e))return;const s=(new Date).getFullYear(),c=parseInt(t.formatDate("Y",t.cacheDate.time),10);e<t.cacheApi.minDate.year&&(i=t.cacheApi.minDate.year),i=10*Math.floor(i/10),n=e-i,n>=t.cacheApi.settings.yearNum&&(i+=Math.floor(n/t.cacheApi.settings.yearNum)*t.cacheApi.settings.yearNum),a=i+t.cacheApi.settings.yearNum-1;const o={};let r=0;"number"==typeof t.cacheDate.startTime&&(o.start=parseInt(t.formatDate("Y",t.cacheDate.startTime),10),"number"==typeof t.cacheApi.settings.rangeMaxYear&&t.cacheApi.settings.rangeMaxYear&&(r=o.start+t.cacheApi.settings.rangeMaxYear),"number"==typeof t.cacheDate.endTime?o.end=parseInt(t.formatDate("Y",t.cacheDate.endTime),10):o.end=o.start);let l="<ul>";for(let e=i;e<=a;e++){const a=[];"range"===t.cacheApi.settings.mode?(e===o.start||e===o.end||e>=o.start&&e<=o.end)&&(a.push("selected"),e===o.start&&a.push("start"),e===o.end&&a.push("end")):e===c&&a.push("selected"),e===s&&a.push("now"),(r&&e>r||e<t.cacheApi.minDate.year||e>t.cacheApi.maxDate.year)&&a.push("del"),l+="<li",a.length&&(l+=' class="'+a.join(" ")+'"'),-1===a.indexOf("del")&&(l+=' data-date="'+e+'"'),l+=">"+e+"</li>"}return l+="</ul>",l},gotoDate:function(e){const t=this,a={},n=t.getSelects(["year","month"],a);void 0===e&&(e=a.year,a.month&&(e+="-"+a.month));const i=t.parseDate(e,!0),s=i.getTime();s<t.cacheApi.minDate.time?i.setTime(t.cacheApi.minDate.time):s>t.cacheApi.maxDate.time&&i.setTime(t.cacheApi.maxDate.time);let c=i.getFullYear(),o=i.getMonth()+1;if("year"===t.cacheApi.settings.type){let e=c;for(let t of n.year.options){const a=parseInt(t.value,10);if(!(a<=c))break;e=a}c=e,e!==a.year&&(n.year.value=e)}else c!==a.year&&(n.year.value=c);n.month&&(c===a.year&&o===a.month||(t.rebuildMonthSelect(),n.month.value=o));const r={start:!0,end:!0};for(let e in n)0!==n[e].selectedIndex&&(r.start=!1),n[e].selectedIndex!==n[e].length-1&&(r.end=!1);for(let e in r)r[e]?t.dom.panel.classList.add("at_"+e):t.dom.panel.classList.contains("at_"+e)&&t.dom.panel.classList.remove("at_"+e);let l="",d="";switch(t.cacheApi.settings.type){case"date":case"datetime":if(l=t.buildDays(c,o),"range"===t.cacheApi.settings.mode){let e=o+1;e>12&&(e=1),d='<span class="year">'+c+"</span><em></em>",d+='<span class="month">'+t.cacheApi.settings.language.monthList[e-1]+"</span><em></em>",l+=t.buildDays(c,o+1)}break;case"month":l=t.buildMonths(c),"range"===t.cacheApi.settings.mode&&(d='<span class="year">'+(c+1)+"</span><em></em>",l+=t.buildMonths(c+1));break;case"year":l=t.buildYears(c),"range"===t.cacheApi.settings.mode&&(d='<span class="year">'+(c+t.cacheApi.settings.yearNum)+" - "+(c+2*t.cacheApi.settings.yearNum-1)+"</span>",l+=t.buildYears(c+t.cacheApi.settings.yearNum))}if(t.dom.dateSet.innerHTML=l,"range"===t.cacheApi.settings.mode){const e=t.dom.head.querySelectorAll("section");e.length>1&&(e[1].innerHTML=d)}},gotoPrev:function(){const e=this,t=e.getSelects(["year","month"]);switch(e.cacheApi.settings.type){case"date":case"datetime":const a=t.month.selectedIndex;a>0?(t.month.selectedIndex-=1,e.gotoDate()):0===a&&t.year.selectedIndex>0&&(t.year.selectedIndex-=1,e.rebuildMonthSelect(),t.month.selectedIndex=t.month.length-1,e.gotoDate());break;case"month":case"year":t.year.selectedIndex>0&&(t.year.selectedIndex-=1,e.gotoDate())}},gotoNext:function(){const e=this,t=e.getSelects(["year","month"]);switch(e.cacheApi.settings.type){case"date":case"datetime":const a=t.month.selectedIndex,n=t.month.length-1;a<n?(t.month.selectedIndex+=1,e.gotoDate()):a===n&&t.year.selectedIndex<t.year.length-1&&(t.year.selectedIndex+=1,e.rebuildMonthSelect(),t.month.selectedIndex=0,e.gotoDate());break;case"month":case"year":t.year.selectedIndex<t.year.length-1&&(t.year.selectedIndex+=1,e.gotoDate())}},showPanel:function(){const e=this;e.delayHide&&clearTimeout(e.delayHide);const t=e.cacheApi.settings.position,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=e.cacheApi.input.getBoundingClientRect(),s=i.width,c=i.height,o=i.top,r=i.left,l=o+window.pageYOffset-document.documentElement.clientTop,d=r+window.pageXOffset-document.documentElement.clientLeft,m=e.dom.panel.getBoundingClientRect(),h=m.width,p=m.height;let g=o+c+p>n&&l-p>=0?l-p:l+c,u=r+h>a&&d-h>=0?d-h+s:d;if("string"==typeof t&&t.length)switch(t){case"fixed":g=null,u=null;break;case"top":g=l-p;break;case"bottom":g=l+c;break;case"left":case"right":g=o+c+p>n?l+c-p:l,u="left"===t?d-h:d+s}"number"==typeof g&&"number"==typeof u&&(e.dom.panel.style.top=g+"px",e.dom.panel.style.left=u+"px"),e.dom.panel.classList.add("show")},hidePanel:function(){const e=this;e.dom.panel.classList.remove("show"),e.delayHide=setTimeout((()=>{e.dom.panel.removeAttribute("style")}),300)},confirmRange:function(){const e=this;let t=[];if(e.cacheDate.startTime&&e.cacheDate.endTime?t.push(e.cacheDate.startTime,e.cacheDate.endTime):e.cacheDate.startTime?t.push(e.cacheDate.startTime,e.cacheDate.startTime):t.push(e.cacheApi.defDate.time,e.cacheApi.defDate.time),["datetime","time"].indexOf(e.cacheApi.settings.type)>=0){const a={hour:[],mint:[],secs:[]};for(let t of e.dom.timeSet.querySelectorAll("select"))a[t.name]&&a[t.name].push(parseInt(t.value));if("datetime"===e.cacheApi.settings.type){const e=[];for(let n=0,i=t.length;n<i;n++)e.push(parseInt([1,a.hour[n],a.mint[n],a.secs[n]].join(""),10));if(e[0]>e[1])for(let e in a)a[e].length>1&&(a[e][1]=a[e][0])}t=t.map(((e,t)=>{const n=new Date(e);return n.setHours(a.hour[t],a.mint[t],a.secs[t],0),n.getTime()}))}e.cacheApi.setDate(t.join(e.cacheApi.settings.rangeSymbol))},confirmTime:function(){const e=this,t=new Date;let a=e.cacheApi.defDate.time;"datetime"===e.cacheApi.settings.type&&"number"==typeof e.cacheDate.time&&(a=e.cacheDate.time),t.setTime(a);const n=Array(4).fill(0),i={hour:0,mint:1,secs:2};for(let t of e.dom.timeSet.querySelectorAll("select"))t.name in i&&(n[i[t.name]]=parseInt(t.value));t.setHours(...n),e.cacheApi.setDate(t.getTime())},detach:function(e){const t=this;if(!t.isElement(e))return;const a="id_"+e.dataset.cxCalendarId;delete e.dataset.cxCalendarId,"function"==typeof t.bindFuns[a]&&(e.removeEventListener("click",t.bindFuns[a]),delete t.bindFuns[a])}};document.addEventListener("DOMContentLoaded",(()=>{e.init()}));const t=function(){const t=this;let a={},n=!1;for(let i of arguments)e.isElement(i)?t.input=i:e.isObject(i)?a=i:"boolean"==typeof i&&(n=i);if(!t.input||!t.input.nodeName||-1===["input","textarea"].indexOf(t.input.nodeName.toLowerCase()))return void console.warn("[cxCalendar] Not input element.");const i=["baseClass","disableWeek","disableDay","endDate","format","hourStep","language","lockRow","minuteStep","position","mode","rangeSymbol","rangeMaxDay","rangeMaxMonth","rangeMaxYear","secondStep","startDate","type","weekStart","yearNum"],s={};for(let e of i)if("string"==typeof t.input.dataset[e]&&t.input.dataset[e].length)switch(e){case"hourStep":case"minuteStep":case"secondStep":case"rangeMaxDay":case"rangeMaxMonth":case"rangeMaxYear":case"weekStart":case"yearNum":s[e]=parseInt(t.input.dataset[e],10);break;case"lockRow":s[e]=Boolean(parseInt(t.input.dataset[e],10));break;case"disableWeek":case"disableDay":s[e]=t.input.dataset[e].split(",");break;default:s[e]=t.input.dataset[e]}Array.isArray(s.disableWeek)&&(s.disableWeek=s.disableWeek.map((e=>parseInt(e,10)))),t.settings=e.extend({},a,s),t.setOptions();let c="id_"+t.input.dataset.cxCalendarId;"function"==typeof e.bindFuns[c]&&e.detach(t.input),t.eventChange=new CustomEvent("change",{bubbles:!0}),n?(t.input.dataset.cxCalendarId=e.cxId,c="id_"+e.cxId,e.cxId++,e.bindFuns[c]=t.show.bind(t),t.input.addEventListener("click",e.bindFuns[c])):t.show()};t.prototype.setOptions=function(t){const a=this;let n,i,s;e.isObject(t)&&e.extend(a.settings,t),n=e.reg.isYear.test(a.settings.endDate)?new Date(a.settings.endDate,11,31):e.parseDate(a.settings.endDate,!0),n.setHours(23,59,59),a.maxDate={year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate(),time:n.getTime()},i=e.reg.isYear.test(a.settings.startDate)?new Date(a.settings.startDate,0,1):e.parseDate(a.settings.startDate),e.isDate(i)||(i=new Date,i.setFullYear(i.getFullYear()-1)),i.getTime()>a.maxDate.time&&(i=new Date(a.maxDate.year-1,a.maxDate.month-1,a.maxDate.day)),i.setHours(0,0,0,0),a.minDate={year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate(),time:i.getTime()};const c={};if("range"===a.settings.mode){const t=String(a.settings.date).split(a.settings.rangeSymbol);if(2===t.length){s=e.parseDate(t[0],!0);const a=e.parseDate(t[1],!0);c.start=s.getTime(),c.end=a.getTime()}}if(s||(s=e.parseDate(a.settings.date,!0)),s.getTime()<a.minDate.time?s=e.parseDate(a.minDate.time,!0):s.getTime()>a.maxDate.time&&(s=e.parseDate(a.maxDate.time,!0)),a.defDate={year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate(),hour:s.getHours(),mint:s.getMinutes(),secs:s.getSeconds(),time:s.getTime(),start:c.start,end:c.end},a.settings.weekStart%=7,a.settings.language=e.getLanguage(a.settings.language),Array.isArray(a.settings.language.holiday)&&a.settings.language.holiday.length){a.holiday={};for(let e of a.settings.language.holiday)a.holiday[e.day]=e.name}},t.prototype.show=function(){const t=this;!t.input.value&&t.settings.date||(t.settings.date=t.input.value),t.setOptions(),e.cacheApi=t,e.buildPanel(),e.showPanel()},t.prototype.hide=function(){e.hidePanel()},t.prototype.getDate=function(t){const a=this,n=a.input.value,i=[];if("string"==typeof t&&t.length||(t=a.settings.format),"range"===a.settings.mode){const e=String(n).split(a.settings.rangeSymbol);2===e.length&&i.push(...e)}else i.push(n);let s=[];for(let n of i){const i=e.parseDate(n);if(!e.isDate(i)){s=[];break}s.push(e.formatDate(t,i.getTime(),a.settings.language))}return s="range"===a.settings.mode?s.join(a.settings.rangeSymbol):s.join(""),s},t.prototype.setDate=function(t){const a=this,n=a.input.value,i=[];if("range"===a.settings.mode){const e=String(t).split(a.settings.rangeSymbol);2===e.length&&i.push(...e)}else i.push(t);let s=[];for(let t of i){const n=e.parseDate(t);if(!e.isDate(n)){s=[];break}let i=n.getTime();i<a.minDate.time?i=a.minDate.time:i>a.maxDate.time&&(i=a.maxDate.time),s.push(e.formatDate(a.settings.format,i,a.settings.language))}s="range"===a.settings.mode?s.join(a.settings.rangeSymbol):s.join(""),n!==s&&(a.input.value=s,a.input.dispatchEvent(a.eventChange))},t.prototype.clearDate=function(){const e=this,t=e.input.value;t&&t.length&&(e.input.value="",e.input.dispatchEvent(e.eventChange))};const a=function(n,i,s){i=e.isObject(i)?e.extend({},a.defaults,i):e.extend({},a.defaults);const c=new t(n,i,s);if(s)return c};return a.attach=function(e,t){return this(e,t,!0)},a.detach=function(t){e.detach(t)},a.defaults={startDate:void 0,endDate:void 0,date:void 0,type:"date",format:"Y-m-d",weekStart:0,lockRow:!1,yearNum:20,hourStep:1,minuteStep:1,secondStep:1,disableWeek:[],disableDay:[],mode:"single",rangeSymbol:" - ",rangeMaxDay:0,rangeMaxMonth:0,rangeMaxYear:0,button:{},position:void 0,baseClass:void 0,language:void 0},a}));
