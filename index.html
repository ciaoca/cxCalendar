<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover">
<title>cxCalendar 日期选择器</title>
<link rel="stylesheet" href="css/cxcalendar.css">
<script src="http://cdn.staticfile.org/jquery/2.1.1-rc2/jquery.min.js"></script>
<script src="js/cxcalendar.js"></script>
<script src="js/cxcalendar.languages.js"></script>
<style>
body{background:#ddd;font:14px/1.7 tahoma,'\5fae\8f6f\96c5\9ed1',sans-serif;}
h1,h2,h3{font-size:36px;line-height:1;}
h2{font-size:24px;}
h3{font-size:18px;}
fieldset{margin:2em 0;}
fieldset legend{font-weight:bold;font-size:16px;line-height:2;}
input,select,button{padding:0.5em;}
a{color:#06f;text-decoration:none;}
a:hover{color:#00f;}

.wrap{width:800px;margin:0 auto;padding:20px 40px;border-radius:8px;background:#fff;box-shadow:0 0 10px rgba(0,0,0,0.5);}

.acts{font-size:12px;}
.acts .group{margin-top:10px;}
.acts a{display:inline-block;padding:5px 10px;border-radius:3px;background-color:#eee;color:#888;}
.acts a:hover{color:#333;}

@media (max-width:900px){
body{margin:0;padding:0;}
.wrap{width:auto;border-radius:0;padding:10px 20px;box-shadow:none;}
}
</style>
</head>
<body>
<div class="wrap">
  <h1>cxCalendar 日期选择器</h1>

  <h2>示例</h2>

  <fieldset>
    <legend>默认</legend>
    <label for="my_day">选择日期：</label>
    <input id="my_day" type="text" readonly>
    <br><br>
    <label for="my_month">选择月份：</label>
    <input id="my_month" type="text" readonly>
    <br><br>
    <label for="my_year">选择年份：</label>
    <input id="my_year" type="text" readonly>
    <br><br>
    <label for="my_time">选择时间：</label>
    <input id="my_time" type="text" readonly>
    <br><br>
    <label for="my_datetime">选择日期和时间：</label>
    <input id="my_datetime" type="text" readonly>
  </fieldset>
  
  <fieldset>
    <legend>&lt;input&gt; 的 value 中设置默认值</legend>
    <label for="my_value">选择日期：</label>
    <input id="my_value" type="text" value="2020-11-1" readonly data-start-date="2018">
  </fieldset>

  <fieldset>
    <legend>限制可选日期</legend>
    <label for="my_disable">选择日期：</label>
    <input id="my_disable" type="text" readonly>
    <p>例：只能选择工作日，以及指定日期不可选。</p>
  </fieldset>

  <fieldset>
    <legend>设定节假日</legend>
    <label for="my_holyday">选择日期：</label>
    <input id="my_holyday" type="text" readonly>
    <p>※ 通过文件 cxcalendar.languages.js 配置。</p>
  </fieldset>

  <fieldset>
    <legend>API 示例</legend>
    <label for="date_api">选择日期：</label>
    <input id="date_api" type="text" class="input" readonly>
    <div id="acts" class="acts">
      <div class="group">
        <a href="javascript://" rel="type" rev="year">type: year</a>
        <a href="javascript://" rel="type" rev="month">type: month</a>
        <a href="javascript://" rel="type" rev="date">type: date</a>
        <a href="javascript://" rel="type" rev="datetime">type: datetime</a>
        <a href="javascript://" rel="type" rev="time">type: time</a>
      </div>
      <div class="group">
        <a href="javascript://" rel="show">显示</a>
        <a href="javascript://" rel="set">设置日期值</a>
        <a href="javascript://" rel="get">获取日期值</a>
        <a href="javascript://" rel="clear">清除日期值</a>
      </div>
      <div class="group">
        <a href="javascript://" rel="lang" rev="zh-cn">设置语言：中文</a>
        <a href="javascript://" rel="lang" rev="en">设置语言：英文</a>
        <a href="javascript://" rel="lang" rev="ja">设置语言：日文</a>
      </div>
    </div>
  </fieldset>

  <fieldset>
    <legend>日期联动</legend>
    <label for="date_first">开始日期：</label>
    <input id="date_first" type="text" readonly>
    <label for="date_last">结束日期：</label>
    <input id="date_last" type="text" readonly>
  </fieldset>

  <p><a target="_blank" href="http://code.ciaoca.com/jquery/cxCalendar/demo/">查看更多示例</a></p>

  <h2>文档</h2>
  <ul>
    <li><a target="_blank" href="https://github.com/ciaoca/cxCalendar">Github</a></li>
    <li><a target="_blank" href="http://code.ciaoca.com/jquery/cxcalendar/">中文文档</a></li>
  </ul>
  
  <h2>作者</h2>
  <p><a target="_blank" href="http://ciaoca.com/">http://ciaoca.com/</a></p>
  <p>Released under the MIT license</p>
</div>

<script>
// 默认：选择日期
$('#my_day').cxCalendar();

// 选择月份
$('#my_month').cxCalendar({
  type: 'month',
  format: 'Y-m'
});

// 选择年份
$('#my_year').cxCalendar({
  type: 'year',
  format: 'Y'
});

// 选择时间
$('#my_time').cxCalendar({
  type: 'time',
  format: 'H:i:s'
});

// 选择日期和时间
$('#my_datetime').cxCalendar({
  // date: '2020-12-1 5:00',
  type: 'datetime',
  format: 'Y-m-d H:i:s'
});

// input 的 value 中有默认值
$('#my_value').cxCalendar({
  endDate: '2020-12-31',
});

// 限制可选日期
$('#my_disable').cxCalendar({
  wday: 0,
  disableWeek: [0,6],
  disableDay: [
    '1',            // 每月1号
    '1-2',          // 每年1月2号
    '2021-1-3',     // 具体日期
  ]
});

// 自定义节假日
$('#my_holyday').cxCalendar({
  baseClass: 'holyday'
});

// API 示例
(function(){
  var nowDate = new Date();
  var cxCalendarApi;

  var getRandomNumber = function(min, max) {
    return Math.round(Math.random() * (max - min) + min);
  };

  $('#date_api').on('change', function(){
    console.log('api-change');
  });

  $('#date_api').cxCalendar({
    startDate: nowDate.getFullYear() - 1,
    endDate: nowDate.getFullYear() + 1,
    position: 'none',

    // date: '2020-11-12',
    // format: 'Y-m-d H:i:s',

    // type: 'month',
    // format: 'Y-m',

    // startDate: '2010-6',

    // type: 'time',
    // format: 'H:i:s',

    // baseClass: 'notsecs en',
    // disableDay: [
    //   '1',
    //   '5/2',
    //   '5/3',
    //   '10/2',
    //   '10/3',
    //   '2021/2/11',
    //   '2021/2/12',
    //   '2021/2/13',
    //   '2021/2/14'
    // ],
  }, function(api){
    cxCalendarApi = api;
  });

  $('#acts').on('click', 'a', function(){
    var _this = this;
    var _rel = _this.rel;
    var _rev = _this.rev;
    var _opt;
    
    switch (_rel) {
      case 'show':
        cxCalendarApi.show();
        break;

      case 'get':
        alert('当前选择日期：' + cxCalendarApi.getDate());
        break;

      case 'set':
        _opt = [nowDate.getFullYear(), getRandomNumber(1,12), getRandomNumber(1,31)].join('/');
        console.log('setDate:', _opt);
        cxCalendarApi.setDate(_opt);
        break;

      case 'clear':
        cxCalendarApi.clearDate();
        break;

      case 'type':
        _opt = {
          type: _rev
        };

        switch (_rev) {
          case 'year':
            _opt.format = 'Y';
            break;

          case 'month':
            _opt.format = 'Y-m';
            break;

          case 'datetime':
            _opt.format = 'Y-m-d H:i:s';
            break;

          case 'time':
            _opt.format = 'H:i:s';
            break;

          default:
            _opt.format = 'Y-m-d';
            break;
        }

        cxCalendarApi.setOptions(_opt);
        cxCalendarApi.show();
        break;

      case 'lang':
        _opt = {
          language: _rev,
          baseClass: ''
        };

        if (_rev !== 'zh-cn') {
          _opt.baseClass = 'en';
        };

        cxCalendarApi.setOptions(_opt);
        cxCalendarApi.show();
        break;
    };
  });
})();

// 日期联动
(function(){
  var dateFirst = $('#date_first');
  var dateLast = $('#date_last');
  var dateFirstApi;
  var dateLastApi;

  dateFirst.cxCalendar(function(api){
    dateFirstApi = api;
  });
  
  dateLast.cxCalendar(function(api){
    dateLastApi = api;
  });

  dateFirst.on('change', function(){
    var firstTime = parseInt(dateFirstApi.getDate('timestamp'), 10);
    var lastTime = parseInt(dateLastApi.getDate('timestamp'), 10);

    if (lastTime < firstTime) {
      dateLastApi.clearDate();
    };

    dateLastApi.setOptions({
      startDate: firstTime
    });

    dateLastApi.show();
  });

  dateLast.on('change', function(){
    console.log('last-change');
  });
})();
</script>
</body>
</html>
